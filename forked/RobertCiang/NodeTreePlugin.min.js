/***
|''Name''|NodeTreePlugin|
|''Description''|Extends TiddlyWiki list markup to add tree diagram type lists.|
|''Version''|0.5.7 (2013-09-22)|
|''Author''|G.J.Robert Ciang (江瑋平) / Tobias Beer|
|''Documentation''|http://nodetree.tiddlyspace.com|
|''Source''|https://raw.github.com/tobibeer/TiddlyWikiPlugins/master/forked/RobertCiang/NodeTreePlugin.min.js|
|''Readable Source''|https://github.com/tobibeer/TiddlyWikiPlugins/blob/master/forked/RobertCiang/NodeTreePlugin.js|
|''License''|CC BY-SA|
|''~CoreVersion''|2.1+|
|''Type''|plugin|
***/
// /%
(function(e){config.formatters.push({name:"NodeTree",match:"^(?:[\\*#;:%\\?/]+)",lookaheadRegExp:/^(?:(?:(\*)|(#)|(;)|(:)|(%)|(\?)|(\/))+)/mg,termRegExp:/(\n{1,2})/mg,handler:function(t){var n=[t.output];var r=0,i=null;var s,o,u,a;t.nextMatch=t.matchStart;this.lookaheadRegExp.lastIndex=t.nextMatch;var f=this.lookaheadRegExp.exec(t.source);while(f&&f.index==t.nextMatch){if(f[1]){o="ul";u="li"}else if(f[2]){o="ol";u="li"}else if(f[3]){o="dl";u="dt"}else if(f[4]){o="dl";u="dd"}else if(f[5]){o="tl";u="ti"}else if(f[6]){o="tl";u="ts"}else if(f[7]){o="tl";u="ts"}if(!a)a=o;s=f[0].length;t.nextMatch+=f[0].length;var l;if(s>r){for(l=r;l<s;l++){var c=r==0?n[n.length-1]:n[n.length-1].lastChild;n.push(createTiddlyElement(c,"div",null,"nt-"+o))}}else if(o!=a&&s==1){t.nextMatch-=f[0].length;return}else if(s<r){for(l=r;l>s;l--)n.pop()}else if(s==r&&o!=i){n.pop();n.push(createTiddlyElement(n[n.length-1].lastChild,"div",null,"nt-"+o))}r=s;i=o;var h=createTiddlyElement(n[n.length-1],"div",null,"nt-"+u);if("ti"==u){e("> .nt-ti-last",e(h).parent()).removeClass("nt-ti-last");e(h).addClass("nt-ti-last")}t.subWikifyTerm(h,this.termRegExp);this.lookaheadRegExp.lastIndex=t.nextMatch;f=this.lookaheadRegExp.exec(t.source)}}});config.formatters.push({name:"NodeTreeParent",match:"&&",termRegExp:/(&&)/mg,element:"div",handler:function(e){e.subWikifyTerm(createTiddlyElement(e.output,this.element,null,"nt-tp"),this.termRegExp)}});config.shadowTiddlers["NodeTreeImages"]="!COMMON\n'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAQRJREFUeF7t0TENwDAQwMCH9vxJpYWQJZKHs3QIPLt7bv0NbxkSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMITGGxBgSY0iMISlnPp2Sauq8hHx5AAAAAElFTkSuQmCC'"+"\n!FIRST\n'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAB9JREFUOE9jGAWjAAQcHBz+A/EhKJd0MGrA0DeAgQEAQ4caCSjqq+0AAAAASUVORK5CYII='"+"\n!LAST\n'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAACxJREFUOE9jcHBw+A/EhxjIBaMGDAYDzMzM/gMx+QYAASsQs0CYo2BEAgYGALC7GdaOpx7MAAAAAElFTkSuQmCC'"+"\n!BAR\n'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAEnQAABJ0Ad5mH3gAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAADNJREFUOE9jGAWDATg4OMiTgBmh2hAAKPifBMwF1YYAWBThw1gNwOZUXBjTC6NgwAEDAwBGSDyrun/7KAAAAABJRU5ErkJggg=='"+"\n!START\n'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAadEVYdFNvZnR3YXJlAFBhaW50Lk5FVCB2My41LjExR/NCNwAAAC5JREFUOE9jGAVDDTg4OMgCsTwyhkoRB4AavgLxf2QMlSIOUMMAyrwwCmgCGBgAuAgaFbnh+uoAAAAASUVORK5CYII='";config.shadowTiddlers["NodeTreeStyles"]="/*{{{*/\n"+store.getTiddlerText(tiddler.title+"##CSS")+"\n/*}}}*/";store.addNotification("NodeTreeStyles",refreshStyles)})(jQuery)
/* 
!CSS
.nt-ti {
display: table-row;
vertical-align: middle;
}
.nt-ti:before {
content: '　';
display: table-cell;
vertical-align: middle;
background-image: url([[NodeTreeImages##COMMON]]), url([[NodeTreeImages##BAR]]);
background-size: 100% 100%, 16px 16px;
background-position: left;
background-repeat:
no-repeat;
}
.nt-ti:first-of-type:before{
background-image: url([[NodeTreeImages##FIRST]]), url([[NodeTreeImages##BAR]]);
background-size: 100% 100%, 16px 16px;
background-position: left;
background-repeat: no-repeat;
}
.nt-ti-last:before {
background-image:url([[NodeTreeImages##LAST]]), url([[NodeTreeImages##BAR]]);
background-size: 100% 100%, 16px 16px;
background-position: left;
background-repeat: no-repeat;
}
.nt-ti:only-child:before,
.nt-ti:only-of-type:before {
background-image: url([[NodeTreeImages##BAR]]);
background-size: 16px 16px;
background-position: left;
background-repeat: no-repeat;
}
.nt-ts, .nt-ts:before {
display: table-cell;
vertical-align: middle;
}
.nt-ts:before {
content: '　';
background-image:url([[NodeTreeImages##COMMON]]);
background-size:100% 100%
}
.nt-ts:first-child:before,
.nt-ts:last-child:before,
.nt-ts:only-child:before{
background-image: none;
}
.nt-ts:before{
display: table-cell;
}
.nt-ts{
display:table-row;
}
.nt-tl{
display: table-cell;
padding-left: 0;
margin-left:0;
vertical-align: middle;}
.nt-tp{
display: table-cell;
vertical-align:middle;
padding-right:1em;
background-image: url([[NodeTreeImages##START]]);
background-size: 16px 16px;
background-position: right;
background-repeat: no-repeat;
}
.nt-tl,
.nt-tp{
border-top:7px solid transparent;
border-bottom:7px solid transparent;
}
.nt-tp + br{
display:none;
}
!END */
// %/