/***
|''Name''|HTML5PlayerPlugin|
|''Author''|[[Tobias Beer|http://tobibeer.tiddlyspace.com]]|
|''Description''|turn a list of links to external media into a playlist and player for HTML5 audio or video|
|''Documentation''|http://html5player.tiddlyspace.com|
|''Version''|0.1.2 (2015-10-02)|
|''Requires''|2.5.2|
|''License''|CC BY-SA|
|''Source''|https://raw.github.com/tobibeer/TiddlyWikiPlugins/master/plugins/HTML5PlayerPlugin.min.js|

{{videoplayer{
# [[Big|http://www.w3schools.com/html/mov_bbb.mp4]]
# [[Buck|http://www.w3schools.com/html/mov_bbb.mp4]]
# [[Bunny|http://www.w3schools.com/html/mov_bbb.mp4]]
}}}
***/
// /%
!function(e){var a=function(){e(".audioplayer, .videoplayer").each(function(a,i){var l=e(i),o=function(){var e=l.find("audio, video")[0];e.paused?e.play():e.pause()},t=function(){var a=e(this);l.find(".playing").removeClass("playing"),a.closest("li").addClass("playing"),y(!0)},n=function(e){var a=l.find("audio, video")[0],i=a.volume;a.volume=e?Math.min(i+.1,1):Math.max(i-.1,0)},r=function(){var e=l.find("audio, video")[0];e.muted=!e.muted},d=function(){var a=l.find("li").not(".playing");e(".playing").removeClass("playing"),a.eq(Math.floor(Math.random()*a.length)).addClass("playing"),y(!0)},s=function(){var a=e(".playing").removeClass("playing").next();a.length||(a=l.find("li").first()),a.addClass("playing"),y(!0)},p=function(){var a=e(".playing").removeClass("playing").prev();a.length||(a=l.find("li").last()),a.addClass("playing"),y(!0)},y=function(a){e("audio, video").each(function(e,a){a.pause()});var i=l.hasClass("videoplayer")?"video":"audio",t=e("<"+i+" controls"+(a?" autoplay":"")+"/>");e("<source/>").attr("src",e(".playing").find("a").attr("src")).attr("type","audio/mpeg").appendTo(t),l.find("audio, video").remove(),t.prependTo(l),t.bind("ended error",function(){l.hasClass("shuffle")?d():s()}),t.bind("keydown",function(e){var a,i=e||window.event,t=i.charCode?i.charCode:i.keyCode;32==t?(o(),a=1):40==t?(s(),a=1):38==t?(p(),a=1):13!=t||i.ctrlKey?77==t?(r(),a=1):83==t?(l.toggleClass("shuffle"),a=1):171==t?(n(1),a=1):173==t&&(n(),a=1):(d(),a=1),a&&(i.stopPropagation(),event.preventDefault())}),t.focus()};l.hasClass("player")||(l.addClass("player"),l.find("a.externalLink").each(function(a,i){var l=e(i);e("<a>").attr("src",l.attr("href")).text(l.text()).click(t).insertAfter(l),l.remove()}),l.find("li").first().addClass("playing"),y(l.hasClass("autoplay")))})};Story.prototype.displayTiddlerPLAYER=Story.prototype.displayTiddler,Story.prototype.displayTiddler=function(){var e=this.displayTiddlerPLAYER.apply(this,arguments);return a(),e},config.shadowTiddlers.HTML5PlayerStyleSheet=["/*{{{*/",".player audio {","  width:100%;","}",".player video {","  min-width:480px;","}",".viewer .player ol{","  margin:0;","  padding:0;","  list-style: decimal-leading-zero inside;","  border-top: 1px solid #ccc;","  color: #ccc; ","}",".player ol li {","  position:relative;","  margin:0;","  padding:0 0 0 10px;","  border-bottom: 1px solid #ccc;","}",".player ol li a {","  position: relative;","  cursor: pointer;","  display: inline-block;","  width: 85%;","  padding: 5px;","}",".player ol li a:before {","  content: 'â™¬';","  display:block;","  position:absolute;","  top: 5px; left: -48px;","  font-size: 1.2em;","  color: transparent;","}",".player.shuffle ol li.playing a:before {","  color: #faa;","}",".player ol li.playing a:before {","  color: #ccc;","}","/*}}}*/"].join("\n"),setStylesheet(store.getRecursiveTiddlerText("HTML5PlayerStyleSheet"),"HTML5PlayerStyleSheet")}(jQuery);
// %/