/***
|''Name''|HTML5PlayerPlugin|
|''Author''|[[Tobias Beer|http://tobibeer.tiddlyspace.com]]|
|''Description''|turn a list of links to external media into a playlist and player for HTML5 audio or video|
|''Documentation''|http://html5player.tiddlyspace.com|
|''Version''|0.1.1 (2015-10-02)|
|''Requires''|2.5.2|
|''License''|CC BY-SA|
|''Source''|https://raw.github.com/tobibeer/TiddlyWikiPlugins/master/plugins/HTML5PlayerPlugin.min.js|

{{videoplayer{
# [[Big|http://www.w3schools.com/html/mov_bbb.mp4]]
# [[Buck|http://www.w3schools.com/html/mov_bbb.mp4]]
# [[Bunny|http://www.w3schools.com/html/mov_bbb.mp4]]
}}}
***/
// /%
!function(a){var e=function(){a(".audioplayer, .videoplayer").each(function(e,i){var l=a(i),o=function(){var a=l.find("audio, video")[0];a.paused?a.play():a.pause()},t=function(){var e=a(this);l.find(".playing").removeClass("playing"),e.closest("li").addClass("playing"),y(!0)},n=function(a){var e=l.find("audio, video")[0],i=e.volume;e.volume=a?Math.min(i+.1,1):Math.max(i-.1,0)},r=function(){var a=l.find("audio, video")[0];a.muted=!a.muted},d=function(){var e=l.find("li").not(".playing");a(".playing").removeClass("playing"),e.eq(Math.floor(Math.random()*e.length)).addClass("playing"),y(!0)},s=function(){var e=a(".playing").removeClass("playing").next();e.length||(e=l.find("li").first()),e.addClass("playing"),y(!0)},p=function(){var e=a(".playing").removeClass("playing").prev();e.length||(e=l.find("li").last()),e.addClass("playing"),y(!0)},y=function(e){a("audio, video").each(function(a,e){e.pause()});var i=l.hasClass("videoplayer")?"video":"audio",t=a("<"+i+" controls"+(e?" autoplay":"")+"/>");a("<source/>").attr("src",a(".playing").find("a").attr("src")).attr("type","audio/mpeg").appendTo(t),l.find("audio, video").remove(),t.prependTo(l),t.bind("ended error",function(){l.hasClass("shuffle")?d():s()}),t.bind("keydown",function(a){var e,i=a||window.event,t=i.charCode?i.charCode:i.keyCode;32==t?(o(),e=1):40==t?(s(),e=1):38==t?(p(),e=1):13!=t||i.ctrlKey?77==t?(r(),e=1):83==t?(l.toggleClass("shuffle"),e=1):171==t?(n(1),e=1):173==t&&(n(),e=1):(d(),e=1),e&&i.stopPropagation()}),t.focus()};l.hasClass("player")||(l.addClass("player"),l.find("a.externalLink").each(function(e,i){var l=a(i);a("<a>").attr("src",l.attr("href")).text(l.text()).click(t).insertAfter(l),l.remove()}),l.find("li").first().addClass("playing"),y(l.hasClass("autoplay")))})};Story.prototype.displayTiddlerPLAYER=Story.prototype.displayTiddler,Story.prototype.displayTiddler=function(){var a=this.displayTiddlerPLAYER.apply(this,arguments);return e(),a},config.shadowTiddlers.HTML5PlayerStyleSheet=["/*{{{*/",".player audio {","  width:100%;","}",".player video {","  min-width:480px;","}",".viewer .player ol{","  margin:0;","  padding:0;","  list-style: decimal-leading-zero inside;","  border-top: 1px solid #ccc;","  color: #ccc; ","}",".player ol li {","  position:relative;","  margin:0;","  padding:0 0 0 10px;","  border-bottom: 1px solid #ccc;","}",".player ol li a {","  position: relative;","  cursor: pointer;","  display: inline-block;","  width: 85%;","  padding: 5px;","}",".player ol li a:before {","  content: 'â™¬';","  display:block;","  position:absolute;","  top: 5px; left: -48px;","  font-size: 1.2em;","  color: transparent;","}",".player.shuffle ol li.playing a:before {","  color: #faa;","}",".player ol li.playing a:before {","  color: #ccc;","}","/*}}}*/"].join("\n"),setStylesheet(store.getRecursiveTiddlerText("HTML5PlayerStyleSheet"),"HTML5PlayerStyleSheet")}(jQuery);
// %/